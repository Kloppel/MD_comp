* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.7 on May, 16. 2024. JOBID=1586719650
* INPUT FILE FOR EQUILIBRATION OF SOLVATED GLOBULAR PROTEIN
* 

!DIMENS CHSIZE 5000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

! Read PSF
open read unit 10 card name step3_pbcsetup.psf
read psf  unit 10 card

!Read Coordinate
open read unit 10 card name step3_pbcsetup.crd
read coor unit 10 card

!
! Setup PBC (Periodic Boundary Condition)
!

stream step3_pbcsetup.str

open read unit 10 card name crystal_image.str
CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
CRYSTAL READ UNIT 10 CARD


!Image centering by residue
IMAGE BYRESID XCEN @xcen YCEN @ycen ZCEN @zcen sele resname TIP3 end

!
! Nonbonded Options
!

nbonds atom vatom vfswitch bycb -
       ctonnb 10.0 ctofnb 12.0 cutnb 16.0 cutim 16.0 -
       inbfrq -1 imgfrq -1 wmin 1.0 cdie eps 1.0 -
       ewald pmew fftx @fftx ffty @ffty fftz @fftz  kappa .34 spline order 6
energy

!
!use positional restraints for equilibration
![you can change the force constant and run longer equilibration (at least 100-200 ps)]
!

define PROT sele ( segid PROA ) end
define CARB sele none end
define HETE sele none end

define BB   sele ( ( type C   .or. type O   .or. type N   .or. type CA  .or. -
                     type P   .or. type O1P .or. type O2P .or. type O5' .or. -
                     type C5' .or. type C4' .or. type C3' .or. type O3' ) .and. PROT ) .or. -
                 ( ( type C+ .or. ( type O5 .and. .bonded. type C1 ) .or. ( type O6 .and. .bonded. type C2 ) ) .and. CARB ) .or. -
                 ( .not. hydrogen .and. HETE ) end
define SC   sele .not. BB .and. .not. hydrogen .and. ( PROT .or. CARB ) end

cons harm force 1.0 sele BB end
cons harm force 0.1 sele SC end

mini SD   nstep 1000 nprint 500
mini ABNR nstep 9000 nprint 500

open write card name "4pti_heat.rst" unit 10

! Heating Process
dynamics VVer strt -
nstep 25000 timestep 0.001 nprint 1000 nsavc 1000 -
nsavv 0 inbfrq -1 iprfrq 1000 ntrfrq 1000 ihtfrq 500 -
iunrea -1 iunwri 10 iuncrd -1 iunvel -1 kunit -1 -
firstt 0.000000 finalt 300.0 teminc 10.0 -
iasors 1 iasvel 1 iscvel 0 ichecw 0

open write card unit 12 name "4pti_heat.crd"
write coor unit 12 card

open write card unit 13 name "4pti_heat.pdb"
write coor pdb unit 13 official

!
! NPT dynamics,
! you can change
! nstep  : number of MD steps
! nprint : print-out frequency
! NOTE:
! The integration time step (timestep) is set to 1 fs only for equilibration
! to avoid any unstable dynamics and thus abnormal termination.
! However, it might be possible to increase it to 2 fs in most applications.
!

set nstep = 500000
set temp = 300

shake bonh param fast

open write unit 14 card name "4pti_equi.rst"
open write unit 15 file name "step4_equi.dcd"

DYNA CPT start timestep 0.001 nstep @nstep -
     nprint 10000 iprfrq 10000 ntrfrq 10000 -
     iunread 10 iunwri 14 iuncrd 15 iunvel -1 kunit -1 -
     nsavc 10000 nsavv 10000 -
     hoover reft @temp tmass 100.0 -
     pmass 500.0 pref 1.0 pgamma 20.0

open write unit 16 card name step4_equilibration.pdb
write coor unit 16 pdb

open write unit 17 card name step4_equilibration.crd
write coor unit 17 card
close unit 17

stop
