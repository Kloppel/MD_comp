#############################################################
## JOB DESCRIPTION                                         ##
#############################################################

# Minimization and Equilibration of 
# 4pti in a Water Box

#############################################################
## ADJUSTABLE PARAMETERS                                   ##
#############################################################

structure          1eru.psf
coordinates        1eru.pdb
set temperature    300
set outputname     1eru_eq
restartsave        yes

 continuing a run
 set inputname       1eru_eq  # only needed to edit once
 binCoordinates      1eru_eq.coor     # coordinates of the previous run
 binVelocities       1eru_eq.vel      # velocities of the previous run
 extendedSystem      1eru_eq.xsc      # celldimensions from last run
firsttimestep        500000                # need to change when doing restarts


#############################################################
## SIMULATION PARAMETERS                                   ##
#############################################################

# Parameters
paraTypeCharmm	    on
parameters              ../toppar_charmm/par_all36m_prot_additions.prm
parameters              ../toppar_charmm/par_all36m_prot.prm
parameters              ../toppar_charmm/par_all36_na.prm
parameters              ../toppar_charmm/par_all36_carb.prm
parameters              ../toppar_charmm/par_all36_lipid.prm
parameters              ../toppar_charmm/par_all36_cgenff.prm
parameters              ../toppar_charmm/toppar_all36_moreions.str
parameters              ../toppar_charmm/toppar_water_ions.str
parameters              ../toppar_charmm/toppar_dum_noble_gases.str
parameters              ../toppar_charmm/toppar_ions_won.str
parameters              ../toppar_charmm/toppar_all36_prot_arg0.str
parameters              ../toppar_charmm/toppar_all36_prot_heme.str
parameters              ../toppar_charmm/toppar_all36_lipid_sphingo.str
parameters              ../toppar_charmm/toppar_all36_lipid_archaeal.str
parameters              ../toppar_charmm/toppar_all36_lipid_bacterial.str
parameters              ../toppar_charmm/toppar_all36_lipid_cardiolipin.str
parameters              ../toppar_charmm/toppar_all36_lipid_cholesterol.str
parameters              ../toppar_charmm/toppar_all36_lipid_dag.str
parameters              ../toppar_charmm/toppar_all36_lipid_inositol.str
parameters              ../toppar_charmm/toppar_all36_lipid_lnp.str
parameters              ../toppar_charmm/toppar_all36_lipid_lps.str
parameters              ../toppar_charmm/toppar_all36_lipid_mycobacterial.str
parameters              ../toppar_charmm/toppar_all36_lipid_miscellaneous.str
parameters              ../toppar_charmm/toppar_all36_lipid_model.str
parameters              ../toppar_charmm/toppar_all36_lipid_prot.str
parameters              ../toppar_charmm/toppar_all36_lipid_tag.str
parameters              ../toppar_charmm/toppar_all36_lipid_yeast.str
parameters              ../toppar_charmm/toppar_all36_lipid_detergent.str

# Input

# temperature         $temperature


# Force-Field Parameters
exclude             scaled1-4   #exclude/scale local (along the sequence)
1-4scaling          1.0         #Scale factor for (i,i+4) EL interactions
cutoff              12.0
switching           on
switchdist          10.0
pairlistdist        14.0


# Integrator Parameters
timestep            2.0  ;# 2fs/step
rigidBonds          all  ;# needed for 2fs steps
nonbondedFreq       1
fullElectFrequency  2  
stepspercycle       10
useSettle on             ;# Apply SETTLE (implement for water)
rigidTolerance 0.00001   ;# Desired accuracy in maintaining shaked bond lengths
rigidIterations    100   ;# Maximum number of shaked iterations

### Particle Mesh Ewald
PME                 on   ;# Use PME for electrostatic calculation - use only factors of 2,3,5
PMETolerance   0.000001  ;# Def 1E-6
PMEInterpOrder      4    ;# Def 4 (cubic+1)
PMEGridSpacing      1.0

# Constant Temperature Control
langevin            on   ;# do langevin dynamics
langevinDamping     1    ;# damping coefficient (gamma) of 1/ps
langevinTemp        300
langevinHydrogen    off  ;# don't couple langevin bath to hydrogens

# Constant Pressure Control
#langevinPiston        on
#langevinPistonTarget  1.01325 ;#  in bar -> 1 atm
#langevinPistonPeriod  200.  # changed from 100 for membrane
#langevinPistonDecay   50.
#langevinPistonTemp    300

cellBasisVector1    63  0.0   0.0  ;# Vector of the axles (x = 1;y = 2;z = 3)
cellBasisVector2    0.0   63  0.0
cellBasisVector3    0.0   0.0   63
cellOrigin          0.04 -0.02 -0.05  ;# Center of the Cube
wrapWater on  	    # Are water molecules translated back to the unit cell (purely cosmetic option, has no effect on simulations
wrapAll on          # Are other molecules such as proteins translated back
useGroupPressure      yes ;# needed for rigidBonds
useFlexibleCell       yes  # changed for membrane
useConstantRatio      yes  # changed for membrane
margin                1.

# Output
outputName          $outputname
restartfreq         10000  ;# 500steps = every 1ps
dcdfreq             10000
xstFreq             10000
outputEnergies      10000

#############################################################
## EXECUTION SCRIPT                                        ##
#############################################################

run                 5000000     ;# 5ps






